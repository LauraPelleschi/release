OASISFormat: 0.4
Name:        release
Version:     2.0.0
Synopsis:    OCaml daemon framework
Authors:     Andre Nathan
License:     MIT

BuildTools:  ocamlbuild
Plugins:     META (0.4), DevFiles (0.4)

Library "release"
  FindlibName:      release
  Path:             lib/core
  BuildDepends:     str,
                    unix,
                    uint.uint32 (>= 1.0.1),
                    uint.uint64 (>= 1.0.1),
                    uint.uint128 (>= 1.0.1)
  CompiledObject:   best
  Modules:          Release,
                    Release_future
  InternalModules:  Release_buffer,
                    Release_bytes,
                    Release_config,
                    Release_config_lexer,
                    Release_config_parser,
                    Release_config_global,
                    Release_config_values,
                    Release_config_validations,
                    Release_io,
                    Release_ipc,
                    Release_privileges,
                    Release_socket,
                    Release_util
  XMETADescription: OCaml daemon framework

Flag async
  Description:      Build the Core Async library
  Default:          false

Library "release-async"
  Build$:           flag(async)
  Install$:         flag(async)
  FindlibName:      async
  FindlibParent:    release
  Path:             lib/async
  BuildDepends:     async,
                    async_extended,
                    threads,
                    release
  CompiledObject:   best
  Modules:          Release_async
  XMETADescription: OCaml daemon framework

Flag lwt
  Description:      Build the Lwt library
  Default:          false

Library "release-lwt"
  Build$:           flag(lwt)
  Install$:         flag(lwt)
  FindlibName:      lwt
  FindlibParent:    release
  Path:             lib/lwt
  BuildDepends:     lwt (>= 2.4.7),
                    lwt.unix (>= 2.4.7),
                    release
  CompiledObject:   best
  Modules:          Release_lwt
  XMETADescription: OCaml daemon framework

Document "release"
  Title:                Release documentation
  Type:                 ocamlbuild (0.3)
  BuildTools+:          ocamldoc
  XOCamlbuildPath:      lib/core
  XOCamlbuildLibraries: release

Executable "test_master"
  Path:            lib_test
  MainIs:          master.ml
  Install:         false
  CompiledObject:  best
  BuildDepends:    release.lwt,
                   str

Executable "test_slave"
  Path:            lib_test
  MainIs:          slave.ml
  Install:         false
  CompiledObject:  best
  BuildDepends:    release.lwt,
                   str

Executable "test_helper"
  Path:            lib_test
  MainIs:          helper.ml
  Install:         false
  CompiledObject:  best
  BuildDepends:    release.lwt,
                   str

Executable "masterctl"
  Path:            lib_test
  MainIs:          masterctl.ml
  Install:         false
  CompiledObject:  best
  BuildDepends:    release.lwt,
                   str

Executable "test_config"
  Path:            lib_test
  MainIs:          config_test.ml
  Install:         false
  CompiledObject:  best
  BuildTools+:     ocamllex, ocamlyacc
  BuildDepends:    release.lwt
